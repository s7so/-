<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 520" role="img" aria-label="Flowchart: US-01 Add Expense">
  <defs>
    <linearGradient id="card" x1="0" x2="1">
      <stop offset="0%" stop-color="#0b0f19"/>
      <stop offset="100%" stop-color="#121826"/>
    </linearGradient>
    <linearGradient id="accent" x1="0" x2="1">
      <stop offset="0%" stop-color="#8b5cf6"/>
      <stop offset="100%" stop-color="#22d3ee"/>
    </linearGradient>
    <linearGradient id="error" x1="0" x2="1">
      <stop offset="0%" stop-color="#f43f5e"/>
      <stop offset="100%" stop-color="#f59e0b"/>
    </linearGradient>
    <marker id="arrow" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#94a3b8"/>
    </marker>
    <marker id="arrowAccent" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#8b5cf6"/>
    </marker>
    <marker id="arrowError" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#f43f5e"/>
    </marker>
    <style>
      .bg { fill: url(#card); }
      .frame { fill: none; stroke: rgba(148,163,184,0.25); }
      .note { fill: #94a3b8; font: 12px/1.4 ui-sans-serif, -apple-system, Segoe UI, Roboto, Helvetica, Arial; }
      .label { fill: #e5e7eb; font: 13px/1.3 ui-sans-serif, -apple-system, Segoe UI, Roboto, Helvetica, Arial; font-weight: 600; }
      .chip { fill: rgba(148,163,184,0.12); stroke: rgba(148,163,184,0.25); }
      .chiptext { fill: #94a3b8; font: 11px/1.2 ui-sans-serif, -apple-system, Segoe UI, Roboto, Helvetica, Arial; }
      .node { fill: rgba(15,23,42,0.6); stroke: rgba(148,163,184,0.35); filter: drop-shadow(0 6px 20px rgba(0,0,0,0.35)); }
      .success { stroke: url(#accent); }
      .error { stroke: url(#error); }
      .line { stroke: #94a3b8; stroke-width: 2; fill: none; marker-end: url(#arrow); }
      .lineAcc { stroke: url(#accent); stroke-width: 2.2; fill: none; marker-end: url(#arrowAccent); }
      .lineErr { stroke: url(#error); stroke-width: 2.2; fill: none; marker-end: url(#arrowError); }
    </style>
  </defs>

  <rect class="bg" x="0" y="0" width="1000" height="520" rx="16"/>
  <rect class="frame" x="10" y="10" width="980" height="500" rx="14"/>
  <text class="note" x="28" y="36">US‑01: Add Expense — Happy path + Error branches</text>

  <!-- Start -->
  <circle class="node" cx="90" cy="100" r="26"/>
  <text class="label" x="76" y="105">Start</text>

  <!-- Open Modal -->
  <rect class="node" x="150" y="70" width="160" height="60" rx="10"/>
  <text class="label" x="160" y="105">Open AddExpenseModal</text>

  <!-- User Enters Data -->
  <rect class="node" x="340" y="70" width="160" height="60" rx="10"/>
  <text class="label" x="352" y="105">User Enters Data</text>

  <!-- Validate Input (Decision diamond) -->
  <path class="node" d="M 560 100 L 620 70 L 680 100 L 620 130 Z"/>
  <text class="label" x="580" y="105">Validate Input</text>
  <rect class="chip" x="590" y="136" width="60" height="18" rx="9"/>
  <text class="chiptext" x="600" y="149">Dev/QA</text>

  <!-- Show Validation Error -->
  <rect class="node" x="580" y="200" width="180" height="54" rx="10"/>
  <text class="label" x="592" y="232">Show ValidationErrorToast</text>

  <!-- Call API -->
  <rect class="node" x="760" y="70" width="160" height="60" rx="10"/>
  <text class="label" x="790" y="105">Call API /expenses</text>

  <!-- API Response (Decision) -->
  <path class="node" d="M 960 100 L 990 80 L 1020 100 L 990 120 Z" transform="translate(-10,0)"/>
  <text class="label" x="950" y="105">API Response?</text>
  <rect class="chip" x="946" y="136" width="84" height="18" rx="9"/>
  <text class="chiptext" x="954" y="149">SRE/DevOps</text>

  <!-- API YES branch: Success path (down) -->
  <rect class="node" x="900" y="210" width="170" height="50" rx="10"/>
  <text class="label" x="930" y="240">Show SuccessToast</text>
  <rect class="node" x="900" y="280" width="220" height="50" rx="10"/>
  <text class="label" x="910" y="312">Refresh List / Update Cache</text>

  <!-- API NO branch: Retry + Error -->
  <rect class="node" x="700" y="210" width="190" height="50" rx="10"/>
  <text class="label" x="712" y="242">Retry (backoff) up to 3</text>
  <rect class="node" x="700" y="280" width="240" height="50" rx="10"/>
  <text class="label" x="712" y="312">Log Error & Show SystemError</text>

  <!-- End circles -->
  <circle class="node" cx="620" cy="300" r="20"/>
  <text class="label" x="610" y="305">End</text>
  <circle class="node" cx="820" cy="360" r="20"/>
  <text class="label" x="810" y="365">End</text>
  <circle class="node" cx="1010" cy="360" r="20"/>
  <text class="label" x="1000" y="365">End</text>

  <!-- connectors -->
  <path class="lineAcc" d="M116 100 H150"/>
  <path class="lineAcc" d="M310 100 H340"/>
  <path class="lineAcc" d="M500 100 H560"/>

  <!-- Validate decision branches -->
  <path class="lineErr" d="M620 130 V180"/>
  <path class="lineAcc" d="M680 100 H760"/>

  <!-- From validation error to End -->
  <path class="lineErr" d="M670 227 H740 V280 H620 V280 V280"/>
  <path class="lineErr" d="M620 254 V280"/>

  <!-- API decision branches (down to success / left-down to retry) -->
  <path class="lineAcc" d="M980 120 V210"/>
  <path class="lineErr" d="M960 100 H880 V235"/>

  <!-- Success chain to End -->
  <path class="lineAcc" d="M985 260 V280"/>
  <path class="lineAcc" d="M1010 330 V340"/>

  <!-- Retry chain to End -->
  <path class="lineErr" d="M820 260 V280"/>
  <path class="lineErr" d="M820 330 V340"/>

  <!-- small YES/NO labels -->
  <text class="chiptext" x="690" y="92">YES</text>
  <text class="chiptext" x="628" y="170">NO</text>
  <text class="chiptext" x="988" y="192">YES</text>
  <text class="chiptext" x="902" y="95">NO</text>

  <!-- legend -->
  <rect class="chip" x="28" y="460" width="380" height="30" rx="8"/>
  <circle cx="44" cy="475" r="6" fill="url(#accent)"/>
  <text class="chiptext" x="56" y="480">Happy path</text>
  <circle cx="146" cy="475" r="6" fill="url(#error)"/>
  <text class="chiptext" x="160" y="480">Error path</text>
  <rect x="260" y="468" width="14" height="14" rx="2" fill="rgba(15,23,42,0.6)" stroke="rgba(148,163,184,0.35)"/>
  <text class="chiptext" x="280" y="480">Node</text>
  <path d="M 340 468 L 354 475 L 340 482 Z" fill="#94a3b8"/>
  <text class="chiptext" x="360" y="480">Arrow</text>
</svg>
